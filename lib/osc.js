!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["osc-min"]=t():e["osc-min"]=t()}(global,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){(function(){var e;e=r(1),t.fromBuffer=function(t,r){return t instanceof ArrayBuffer?t=new Buffer(new Uint8Array(t)):t instanceof Uint8Array&&(t=new Buffer(t)),e.fromOscPacket(t,r)},t.toBuffer=function(t,r,n){return"string"==typeof t?e.toOscPacket({address:t,args:r},n):e.toOscPacket(t,r)},t.applyAddressTransform=function(t,r){return e.applyTransform(t,e.addressTransform(r))},t.applyMessageTransform=function(t,r){return e.applyTransform(t,e.messageTransform(r))},t.timetagToDate=e.timetagToDate,t.dateToTimetag=e.dateToTimetag,t.timetagToTimestamp=e.timetagToTimestamp,t.timestampToTimetag=e.timestampToTimetag}).call(this)},function(e,t){var r,n,o,i,u,s,a,f,l,c={}.hasOwnProperty;t.concat=function(e){var t,n,o,i,u,s,a,f,l,c;if(!r(e))throw new Error("concat must take an array of buffers");for(i=0,a=e.length;i<a;i++)if(t=e[i],!Buffer.isBuffer(t))throw new Error("concat must take an array of buffers");for(c=0,u=0,f=e.length;u<f;u++)c+=(t=e[u]).length;for(o=new Buffer(c),n=0,s=0,l=e.length;s<l;s++)(t=e[s]).copy(o,n),n+=t.length;return o},t.toOscString=function(e,t){var r,o,i;if("string"!=typeof e)throw new Error("can't pack a non-string into an osc-string");if(-1!==(o=e.indexOf("\0"))&&t)throw n("Can't pack an osc-string that contains NULL characters");for(-1!==o&&(e=e.slice(0,o)),r=0,i=f(e);0<=i?r<i:r>i;0<=i?++r:--r)e+="\0";return new Buffer(e)},t.splitOscString=function(e,t){var r,o,i,u,s,a,l,c;if(!Buffer.isBuffer(e))throw n("Can't split something that isn't a buffer");if(-1===(i=(u=e.toString("utf8")).indexOf("\0"))){if(t)throw new Error("All osc-strings must contain a null character");return{string:u,rest:new Buffer(0)}}if(c=u.slice(0,i),l=Buffer.byteLength(c)+f(c),t&&l>e.length)throw n("Not enough padding for osc-string");if(t)for(r=o=s=Buffer.byteLength(c),a=l;s<=a?o<a:o>a;r=s<=a?++o:--o)if(0!==e[r])throw n("Not enough or incorrect padding for osc-string");return{string:c,rest:e.slice(l,e.length)}},t.splitInteger=function(e){if(4,e.length<4)throw new Error("buffer is not big enough for integer type");return 0,{integer:e.readInt32BE(),rest:e.slice(4,e.length)}},t.splitTimetag=function(e){if(4,e.length<8)throw new Error("buffer is not big enough to contain a timetag");return{timetag:[e.readUInt32BE(),e.readUInt32BE(4)],rest:e.slice(8,e.length)}},t.dateToTimetag=function(e){return t.timestampToTimetag(e.getTime()/1e3)},t.timestampToTimetag=function(e){var t;return t=Math.floor(e),u(t,e-t)},t.timetagToTimestamp=function(e){return e[0]+t.ntpToFractionalSeconds(e[1])-2208988800},u=function(e,t){return[e+2208988800,Math.round(4294967296*t)]},t.timetagToDate=function(e){var r,n,o,i,u;return[u,i]=e,u-=2208988800,o=t.ntpToFractionalSeconds(i),(r=new Date).setTime(1e3*u+1e3*o),(n=new Date).setUTCFullYear(r.getUTCFullYear()),n.setUTCMonth(r.getUTCMonth()),n.setUTCDate(r.getUTCDate()),n.setUTCHours(r.getUTCHours()),n.setUTCMinutes(r.getUTCMinutes()),n.setUTCSeconds(r.getUTCSeconds()),n.setUTCMilliseconds(1e3*o),n},t.deltaTimetag=function(e,r){var n;return n=(null!=r?r:new Date)/1e3,t.timestampToTimetag(n+e)},t.ntpToFractionalSeconds=function(e){return parseFloat(e)/4294967296},t.toTimetagBuffer=function(e){var r;if("number"==typeof e)e=t.timestampToTimetag(e);else if("object"==typeof e&&"getTime"in e)e=t.dateToTimetag(e);else if(2!==e.length)throw new Error("Invalid timetag"+e);return(r=Buffer.alloc(8)).writeUInt32BE(e[0]),r.writeUInt32BE(e[1],4),r},t.toIntegerBuffer=function(e){var t;if("number"!=typeof e)throw new Error("cannot pack a non-number into an integer buffer");return(t=Buffer.alloc(4)).writeInt32BE(e),t},a={s:{representation:"string",split:function(e,r){var n;return{value:(n=t.splitOscString(e,r)).string,rest:n.rest}},toArg:function(e,r){if("string"!=typeof e)throw new Error("expected string");return t.toOscString(e,r)}},i:{representation:"integer",split:function(e,r){var n;return{value:(n=t.splitInteger(e)).integer,rest:n.rest}},toArg:function(e,r){if("number"!=typeof e)throw new Error("expected number");return t.toIntegerBuffer(e)}},t:{representation:"timetag",split:function(e,r){var n;return{value:(n=t.splitTimetag(e)).timetag,rest:n.rest}},toArg:function(e,r){return t.toTimetagBuffer(e)}},f:{representation:"float",split:function(e,t){return{value:e.readFloatBE(0),rest:e.slice(4,e.length)}},toArg:function(e,t){var r;if("number"!=typeof e)throw new Error("expected number");return(r=Buffer.alloc(4)).writeFloatBE(e),r}},d:{representation:"double",split:function(e,t){return{value:e.readDoubleBE(0),rest:e.slice(8,e.length)}},toArg:function(e,t){var r;if("number"!=typeof e)throw new Error("expected number");return(r=Buffer.alloc(8)).writeDoubleBE(e),r}},b:{representation:"blob",split:function(e,r){var n;return({integer:n,rest:e}=t.splitInteger(e)),{value:e.slice(0,n),rest:e.slice(n,e.length)}},toArg:function(e,r){var n;if(!Buffer.isBuffer(e))throw new Error("expected node.js Buffer");return n=t.toIntegerBuffer(e.length),t.concat([n,e])}},T:{representation:"true",split:function(e,t){return{rest:e,value:!0}},toArg:function(e,t){if(!e&&t)throw new Error("true must be true");return new Buffer(0)}},F:{representation:"false",split:function(e,t){return{rest:e,value:!1}},toArg:function(e,t){if(e&&t)throw new Error("false must be false");return new Buffer(0)}},N:{representation:"null",split:function(e,t){return{rest:e,value:null}},toArg:function(e,t){if(e&&t)throw new Error("null must be false");return new Buffer(0)}},I:{representation:"bang",split:function(e,t){return{rest:e,value:"bang"}},toArg:function(e,t){return new Buffer(0)}}},t.oscTypeCodeToTypeString=function(e){var t;return null!=(t=a[e])?t.representation:void 0},t.typeStringToOscTypeCode=function(e){var t,r;for(t in a)if(c.call(a,t)&&(({representation:r}=a[t]),r===e))return t;return null},t.argToTypeCode=function(e,r){var n,o;if(null!=(null!=e?e.type:void 0)&&"string"==typeof e.type&&null!=(n=t.typeStringToOscTypeCode(e.type)))return n;if(o=null!=(null!=e?e.value:void 0)?e.value:e,r&&null==o)throw new Error("Argument has no value");if("string"==typeof o)return"s";if("number"==typeof o)return"f";if(Buffer.isBuffer(o))return"b";if("boolean"==typeof o)return o?"T":"F";if(null===o)return"N";throw new Error("I don't know what type this is supposed to be.")},t.splitOscArgument=function(e,r,n){var o;if(null!=(o=t.typeStringToOscTypeCode(r)))return a[o].split(e,n);throw new Error(`I don't understand how I'm supposed to unpack ${r}`)},t.toOscArgument=function(e,r,n){var o;if(null!=(o=t.typeStringToOscTypeCode(r)))return a[o].toArg(e,n);throw new Error(`I don't know how to pack ${r}`)},t.fromOscMessage=function(e,r){var o,i,u,s,a,f,l,c,g,p;if(({string:o,rest:e}=t.splitOscString(e,r)),r&&"/"!==o[0])throw n("addresses must start with /");if(!e.length)return{address:o,args:[]};if(({string:p,rest:e}=t.splitOscString(e,r)),","!==p[0]){if(r)throw n("Argument lists must begin with ,");return{address:o,args:[]}}for(s=[u=[]],f=0,l=(p=p.slice(1,+p.length+1||9e9)).length;f<l;f++)if("["!==(c=p[f]))if("]"!==c){if(null==(g=t.oscTypeCodeToTypeString(c)))throw new Error(`I don't understand the argument code ${c}`);null!=(i=t.splitOscArgument(e,g,r))&&(e=i.rest),s[s.length-1].push({type:g,value:null!=i?i.value:void 0})}else if(s.length<=1){if(r)throw new n("Mismatched ']' character.")}else a=s.pop(),s[s.length-1].push({type:"array",value:a});else s.push([]);if(1!==s.length&&r)throw new n("Mismatched '[' character");return{address:o,args:u,oscType:"message"}},t.fromOscBundle=function(e,r){var n,o;if(({string:n,rest:e}=t.splitOscString(e,r)),"#bundle"!==n)throw new Error("osc-bundles must begin with #bundle");return({timetag:o,rest:e}=t.splitTimetag(e)),{timetag:o,elements:s(e,(function(e){return t.fromOscPacket(e,r)})),oscType:"bundle"}},t.fromOscPacket=function(e,r){return i(e,r)?t.fromOscBundle(e,r):t.fromOscMessage(e,r)},o=function(e){return r(e)?e:"array"===(null!=e?e.type:void 0)&&r(null!=e?e.value:void 0)?e.value:null!=e&&null==e.type&&r(e.value)?e.value:null},l=function(e,r){var n,i,u,s,a,f,c,g,p,d;for(f="",a=[],u=0,s=e.length;u<s;u++)n=e[u],null==o(n)?null!=(p=t.argToTypeCode(n,r))&&(void 0===(d=null!=n?n.value:void 0)&&(d=n),null!=(i=t.toOscArgument(d,t.oscTypeCodeToTypeString(p),r))&&(a.push(i),f+=p)):([g,c]=l(o(n),r),f+="["+g+"]",a=a.concat(c));return[f,a]},t.toOscMessage=function(e,n){var o,i,u,s,a,f,c;if("string"!=typeof(o=null!=(null!=e?e.address:void 0)?e.address:e))throw new Error("message must contain an address");return void 0===(u=null!=e?e.args:void 0)&&(u=[]),r(u)||(s=u,(u=[])[0]=s),a=t.toOscString(o,n),[c,f]=l(u,n),c=","+c,i=t.concat(f),c=t.toOscString(c),t.concat([a,c,i])},t.toOscBundle=function(e,o){var i,u,s,a,f,l,c,g,p,d,m,h,T,w;if(o&&null==(null!=e?e.timetag:void 0))throw n("bundles must have timetags.");for(w=null!=(m=null!=e?e.timetag:void 0)?m:new Date,a=null!=(h=null!=e?e.elements:void 0)?h:[],r(a)||(f=a,(a=[]).push(f)),g=t.toOscString("#bundle"),d=t.toTimetagBuffer(w),p=[],l=0,c=a.length;l<c;l++){s=a[l];try{u=t.toOscPacket(s,o),T=t.toIntegerBuffer(u.length),p.push(t.concat([T,u]))}catch(e){e}}return i=t.concat(p),t.concat([g,d,i])},t.toOscPacket=function(e,r){return null!=(null!=e?e.oscType:void 0)?"bundle"===e.oscType?t.toOscBundle(e,r):t.toOscMessage(e,r):null!=(null!=e?e.timetag:void 0)||null!=(null!=e?e.elements:void 0)?t.toOscBundle(e,r):t.toOscMessage(e,r)},t.applyMessageTranformerToBundle=function(e){return function(r){var n,o,i,u,a,f,l,c,g,p,d,m;if(({string:p,rest:r}=t.splitOscString(r)),"#bundle"!==p)throw new Error("osc-bundles must begin with #bundle");for(n=t.toOscString(p),d=r.slice(0,8),r=r.slice(8,r.length),u=s(r,(function(r){return t.applyTransform(r,e,t.applyMessageTranformerToBundle(e))})),m=n.length+d.length,a=0,l=u.length;a<l;a++)m+=4+(i=u[a]).length;for(g=new Buffer(m),n.copy(g,0),d.copy(g,n.length),o=n.length+d.length,f=0,c=u.length;f<c;f++)i=u[f],t.toIntegerBuffer(i.length).copy(g,o),o+=4,i.copy(g,o),o+=i.length;return g}},t.applyTransform=function(e,r,n){return null==n&&(n=t.applyMessageTranformerToBundle(r)),i(e)?n(e):r(e)},t.addressTransform=function(e){return function(r){var n,o;return({string:o,rest:n}=t.splitOscString(r)),o=e(o),t.concat([t.toOscString(o),n])}},t.messageTransform=function(e){return function(r){var n;return n=t.fromOscMessage(r),t.toOscMessage(e(n))}},r=Array.isArray,n=function(e){return new Error("Strict Error: "+e)},f=function(e){return 4-Buffer.byteLength(e)%4},i=function(e,r){var n;return({string:n}=t.splitOscString(e,r)),"#bundle"===n},s=function(e,r){var n,o,i,u,s,a,f;for(s=[],i=0,u=(o=function(){var n;for(n=[];e.length;){if(({integer:a,rest:e}=t.splitInteger(e)),a>e.length)throw new Error("Invalid bundle list: size of element is bigger than buffer");f=e.slice(0,a),e=e.slice(a,e.length);try{n.push(r(f))}catch(e){e,n.push(null)}}return n}()).length;i<u;i++)null!=(n=o[i])&&s.push(n);return s}}])}));
//# sourceMappingURL=index.min.js.map